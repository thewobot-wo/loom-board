---
phase: 02-react-frontend
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - src/components/Board/Board.tsx
  - src/components/Board/Board.module.css
  - src/components/Board/index.ts
  - src/components/Column/Column.tsx
  - src/components/Column/Column.module.css
  - src/components/Column/ColumnSkeleton.tsx
  - src/components/Column/index.ts
  - src/components/Task/TaskCard.tsx
  - src/components/Task/TaskCard.module.css
  - src/components/Task/TaskSkeleton.tsx
  - src/components/Task/index.ts
  - src/lib/constants.ts
  - src/lib/utils.ts
  - src/App.tsx
autonomous: true

must_haves:
  truths:
    - "4-column board renders (Backlog, In Progress, Blocked, Done)"
    - "Tasks appear in their correct columns based on status"
    - "Skeleton loaders show while data loads"
    - "Task cards display title, description, priority, tags, due date"
  artifacts:
    - path: "src/components/Board/Board.tsx"
      provides: "4-column grid layout"
      contains: "grid-template-columns"
    - path: "src/components/Column/Column.tsx"
      provides: "Column with header and task list"
      contains: "column-title"
    - path: "src/components/Task/TaskCard.tsx"
      provides: "Task card with priority indicator"
      contains: "priority"
    - path: "src/lib/constants.ts"
      provides: "Status and priority mappings"
      contains: "STATUS_CONFIG"
  key_links:
    - from: "src/components/Board/Board.tsx"
      to: "api.tasks.listTasks"
      via: "useQuery hook"
      pattern: "useQuery.*listTasks"
    - from: "src/components/Column/Column.tsx"
      to: "TaskCard"
      via: "maps tasks to TaskCard components"
      pattern: "tasks\\.map.*TaskCard"
---

<objective>
Create the core component structure: Board, Column, and TaskCard with feature folder organization.

Purpose: Build the visual foundation of the Kanban board with proper component hierarchy, CSS modules, and Convex data display.

Output: 4-column board showing all tasks from Convex with proper styling.
</objective>

<execution_context>
@/Users/criswo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/criswo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-react-frontend/02-CONTEXT.md
@.planning/phases/02-react-frontend/02-RESEARCH.md
@.planning/phases/02-react-frontend/02-01-SUMMARY.md
@convex/schema.ts
@loom-board.html (column/task card styles)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create utility functions and constants</name>
  <files>
    src/lib/constants.ts
    src/lib/utils.ts
  </files>
  <action>
Create src/lib/constants.ts with status and priority configuration:
```typescript
export const STATUS_CONFIG = {
  backlog: {
    label: "Backlog",
    color: "var(--text-muted)",
    dbValue: "backlog" as const,
  },
  in_progress: {
    label: "In Progress",
    color: "var(--accent-blue)",
    dbValue: "in_progress" as const,
  },
  blocked: {
    label: "Blocked",
    color: "var(--accent-red)",
    dbValue: "blocked" as const,
  },
  done: {
    label: "Done",
    color: "var(--accent-green)",
    dbValue: "done" as const,
  },
} as const;

export type Status = keyof typeof STATUS_CONFIG;

export const PRIORITY_CONFIG = {
  urgent: {
    label: "P0 Critical",
    color: "var(--accent-red)",
    dbValue: "urgent" as const,
  },
  high: {
    label: "P1 High",
    color: "var(--accent-yellow)",
    dbValue: "high" as const,
  },
  medium: {
    label: "P2 Normal",
    color: "var(--accent-blue)",
    dbValue: "medium" as const,
  },
  low: {
    label: "P3 Low",
    color: "var(--text-muted)",
    dbValue: "low" as const,
  },
} as const;

export type Priority = keyof typeof PRIORITY_CONFIG;

export const TAG_COLORS: Record<string, { bg: string; text: string }> = {
  project: { bg: "rgba(31, 111, 235, 0.15)", text: "var(--accent-blue)" },
  research: { bg: "rgba(137, 87, 229, 0.15)", text: "var(--accent-purple)" },
  bug: { bg: "rgba(248, 81, 73, 0.15)", text: "var(--accent-red)" },
  feature: { bg: "rgba(63, 185, 80, 0.15)", text: "var(--accent-green)" },
  maintenance: { bg: "rgba(210, 153, 34, 0.15)", text: "var(--accent-yellow)" },
  cruise: { bg: "rgba(163, 113, 247, 0.15)", text: "#bc8cff" },
};

export const COLUMN_ORDER: Status[] = ["backlog", "in_progress", "blocked", "done"];
```

Create src/lib/utils.ts:
```typescript
export function escapeHtml(text: string | undefined): string {
  if (!text) return "";
  const div = document.createElement("div");
  div.textContent = text;
  return div.innerHTML;
}

export function formatDate(date: Date | number): string {
  const d = new Date(date);
  return d.toLocaleDateString("en-US", { month: "short", day: "numeric" });
}

export function formatTime(timestamp: number): string {
  const d = new Date(timestamp);
  return d.toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit" });
}

export function formatDuration(minutes: number): string {
  if (minutes < 60) return `${minutes}m`;
  const hours = Math.floor(minutes / 60);
  const mins = minutes % 60;
  return mins > 0 ? `${hours}h ${mins}m` : `${hours}h`;
}

export function isOverdue(dueDate: number | undefined): boolean {
  if (!dueDate) return false;
  return new Date(dueDate) < new Date();
}

export function isDueSoon(dueDate: number | undefined): boolean {
  if (!dueDate) return false;
  const due = new Date(dueDate);
  const now = new Date();
  const twoDaysFromNow = new Date(now.getTime() + 2 * 24 * 60 * 60 * 1000);
  return due > now && due < twoDaysFromNow;
}
```
  </action>
  <verify>
- `npx tsc --noEmit` passes (no type errors in new files)
- Files exist: `ls src/lib/constants.ts src/lib/utils.ts`
  </verify>
  <done>
Utility functions and constants exported for use in components.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create TaskCard component with CSS module</name>
  <files>
    src/components/Task/TaskCard.tsx
    src/components/Task/TaskCard.module.css
    src/components/Task/TaskSkeleton.tsx
    src/components/Task/index.ts
  </files>
  <action>
Create src/components/Task/TaskCard.module.css (migrate styles from loom-board.html .task):
```css
.card {
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 14px;
  cursor: grab;
  transition: var(--transition);
  position: relative;
}

.card:hover {
  border-color: var(--border-hover);
  transform: translateY(-2px);
  box-shadow: var(--shadow);
}

.dragging {
  opacity: 0.5;
  cursor: grabbing;
}

.priorityIndicator {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  border-radius: var(--radius-sm) var(--radius-sm) 0 0;
}

.priorityUrgent { background: var(--accent-red); }
.priorityHigh { background: var(--accent-yellow); }
.priorityMedium { background: var(--accent-blue); }
.priorityLow { background: var(--text-muted); }

.header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 8px;
  margin-bottom: 8px;
}

.title {
  font-size: 14px;
  font-weight: 500;
  color: var(--text-primary);
  line-height: 1.4;
  flex: 1;
}

.menu {
  opacity: 0;
  transition: opacity 0.2s;
  cursor: pointer;
  padding: 2px 6px;
  border-radius: 4px;
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 16px;
}

.card:hover .menu {
  opacity: 1;
}

.menu:hover {
  background: var(--border);
}

.description {
  font-size: 12px;
  color: var(--text-muted);
  margin-bottom: 12px;
  line-height: 1.5;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 8px;
}

.tags {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}

.tag {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 500;
  text-transform: uppercase;
}

.dueDate {
  font-size: 11px;
  color: var(--text-muted);
  display: flex;
  align-items: center;
  gap: 4px;
}

.overdue {
  color: var(--accent-red);
  font-weight: 500;
}

.dueSoon {
  color: var(--accent-yellow);
}

/* Skeleton styles */
.skeleton {
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 14px;
  animation: pulse 1.5s infinite;
}

.skeletonLine {
  background: var(--border);
  border-radius: 4px;
  margin-bottom: 8px;
}

.skeletonTitle {
  height: 16px;
  width: 80%;
}

.skeletonDesc {
  height: 12px;
  width: 60%;
}

.skeletonMeta {
  height: 20px;
  width: 40%;
  margin-bottom: 0;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}
```

Create src/components/Task/TaskCard.tsx:
```typescript
import { memo } from "react";
import clsx from "clsx";
import type { Doc } from "../../../convex/_generated/dataModel";
import { PRIORITY_CONFIG, TAG_COLORS } from "@/lib/constants";
import { formatDate, isOverdue, isDueSoon } from "@/lib/utils";
import styles from "./TaskCard.module.css";

interface TaskCardProps {
  task: Doc<"tasks">;
  isDragging?: boolean;
  onEdit?: (taskId: string) => void;
}

function TaskCardComponent({ task, isDragging, onEdit }: TaskCardProps) {
  const priorityClass = `priority${task.priority.charAt(0).toUpperCase()}${task.priority.slice(1)}` as keyof typeof styles;

  return (
    <div
      className={clsx(styles.card, { [styles.dragging]: isDragging })}
      data-task-id={task._id}
    >
      <div
        className={clsx(styles.priorityIndicator, styles[priorityClass])}
      />
      <div className={styles.header}>
        <div className={styles.title}>{task.title}</div>
        <button
          className={styles.menu}
          onClick={(e) => {
            e.stopPropagation();
            onEdit?.(task._id);
          }}
          aria-label="Edit task"
        >
          ...
        </button>
      </div>
      {task.description && (
        <div className={styles.description}>{task.description}</div>
      )}
      <div className={styles.meta}>
        <div className={styles.tags}>
          {task.tags.map((tag) => {
            const colors = TAG_COLORS[tag] ?? TAG_COLORS.project;
            return (
              <span
                key={tag}
                className={styles.tag}
                style={{ background: colors.bg, color: colors.text }}
              >
                {tag}
              </span>
            );
          })}
        </div>
        {task.dueDate && (
          <span
            className={clsx(styles.dueDate, {
              [styles.overdue]: isOverdue(task.dueDate) && task.status !== "done",
              [styles.dueSoon]: isDueSoon(task.dueDate),
            })}
          >
            {formatDate(task.dueDate)}
          </span>
        )}
      </div>
    </div>
  );
}

export const TaskCard = memo(TaskCardComponent);
```

Create src/components/Task/TaskSkeleton.tsx:
```typescript
import styles from "./TaskCard.module.css";

export function TaskSkeleton() {
  return (
    <div className={styles.skeleton}>
      <div className={clsx(styles.skeletonLine, styles.skeletonTitle)} />
      <div className={clsx(styles.skeletonLine, styles.skeletonDesc)} />
      <div className={clsx(styles.skeletonLine, styles.skeletonMeta)} />
    </div>
  );
}

// Need clsx import
import clsx from "clsx";
```

Create src/components/Task/index.ts:
```typescript
export { TaskCard } from "./TaskCard";
export { TaskSkeleton } from "./TaskSkeleton";
```

Install clsx:
```bash
npm install clsx
```
  </action>
  <verify>
- `npx tsc --noEmit` passes
- `ls src/components/Task/` shows TaskCard.tsx, TaskCard.module.css, TaskSkeleton.tsx, index.ts
  </verify>
  <done>
TaskCard component renders task with priority indicator, tags, due date, and hover states.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create Column and Board components, wire up in App</name>
  <files>
    src/components/Column/Column.tsx
    src/components/Column/Column.module.css
    src/components/Column/ColumnSkeleton.tsx
    src/components/Column/index.ts
    src/components/Board/Board.tsx
    src/components/Board/Board.module.css
    src/components/Board/index.ts
    src/App.tsx
  </files>
  <action>
Create src/components/Column/Column.module.css:
```css
.column {
  background: var(--bg-secondary);
  border-radius: var(--radius);
  display: flex;
  flex-direction: column;
  max-height: calc(100vh - 200px);
  min-height: 400px;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px;
  border-bottom: 1px solid var(--border);
}

.title {
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
  font-size: 14px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.icon {
  width: 8px;
  height: 8px;
  border-radius: 50%;
}

.count {
  background: var(--bg-tertiary);
  padding: 2px 10px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
}

.taskList {
  flex: 1;
  overflow-y: auto;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.dragOver {
  background: rgba(88, 166, 255, 0.05);
  border-radius: var(--radius-sm);
}

.addButton {
  width: calc(100% - 24px);
  margin: 0 12px 12px;
  padding: 12px;
  background: transparent;
  border: 2px dashed var(--border);
  border-radius: var(--radius-sm);
  color: var(--text-muted);
  font-size: 13px;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.addButton:hover {
  border-color: var(--accent-blue);
  color: var(--accent-blue);
  background: rgba(88, 166, 255, 0.05);
}

/* Skeleton */
.skeleton {
  animation: pulse 1.5s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}
```

Create src/components/Column/Column.tsx:
```typescript
import type { Doc } from "../../../convex/_generated/dataModel";
import { STATUS_CONFIG, type Status } from "@/lib/constants";
import { TaskCard } from "@/components/Task";
import styles from "./Column.module.css";

interface ColumnProps {
  status: Status;
  tasks: Doc<"tasks">[];
  onAddTask?: (status: Status) => void;
  onEditTask?: (taskId: string) => void;
}

export function Column({ status, tasks, onAddTask, onEditTask }: ColumnProps) {
  const config = STATUS_CONFIG[status];
  const showAddButton = status !== "done";

  return (
    <div className={styles.column}>
      <div className={styles.header}>
        <span className={styles.title} style={{ color: config.color }}>
          <span className={styles.icon} style={{ background: config.color }} />
          {config.label}
        </span>
        <span className={styles.count}>{tasks.length}</span>
      </div>
      <div className={styles.taskList}>
        {tasks.map((task) => (
          <TaskCard
            key={task._id}
            task={task}
            onEdit={onEditTask}
          />
        ))}
      </div>
      {showAddButton && (
        <button
          className={styles.addButton}
          onClick={() => onAddTask?.(status)}
        >
          + Add Task
        </button>
      )}
    </div>
  );
}
```

Create src/components/Column/ColumnSkeleton.tsx:
```typescript
import { TaskSkeleton } from "@/components/Task";
import styles from "./Column.module.css";

interface ColumnSkeletonProps {
  count?: number;
}

export function ColumnSkeleton({ count = 3 }: ColumnSkeletonProps) {
  return (
    <div className={`${styles.column} ${styles.skeleton}`}>
      <div className={styles.header}>
        <span className={styles.title}>
          <span className={styles.icon} style={{ background: "var(--border)" }} />
          Loading...
        </span>
        <span className={styles.count}>-</span>
      </div>
      <div className={styles.taskList}>
        {Array.from({ length: count }).map((_, i) => (
          <TaskSkeleton key={i} />
        ))}
      </div>
    </div>
  );
}
```

Create src/components/Column/index.ts:
```typescript
export { Column } from "./Column";
export { ColumnSkeleton } from "./ColumnSkeleton";
```

Create src/components/Board/Board.module.css:
```css
.container {
  padding: 24px;
  max-width: 1800px;
  margin: 0 auto;
}

.board {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
}

@media (max-width: 1200px) {
  .board {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 640px) {
  .board {
    grid-template-columns: 1fr;
  }
}

.loading {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
}

@media (max-width: 1200px) {
  .loading {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 640px) {
  .loading {
    grid-template-columns: 1fr;
  }
}
```

Create src/components/Board/Board.tsx:
```typescript
import { useQuery } from "convex/react";
import { api } from "../../../convex/_generated/api";
import type { Doc } from "../../../convex/_generated/dataModel";
import { COLUMN_ORDER, type Status } from "@/lib/constants";
import { Column, ColumnSkeleton } from "@/components/Column";
import styles from "./Board.module.css";

interface BoardProps {
  onAddTask?: (status: Status) => void;
  onEditTask?: (taskId: string) => void;
}

export function Board({ onAddTask, onEditTask }: BoardProps) {
  const tasks = useQuery(api.tasks.listTasks);

  // Loading state
  if (tasks === undefined) {
    return (
      <div className={styles.container}>
        <div className={styles.loading}>
          {COLUMN_ORDER.map((status) => (
            <ColumnSkeleton key={status} />
          ))}
        </div>
      </div>
    );
  }

  // Group tasks by status and sort by order within each column
  const tasksByStatus = COLUMN_ORDER.reduce(
    (acc, status) => {
      acc[status] = tasks
        .filter((t) => t.status === status)
        .sort((a, b) => a.order - b.order);
      return acc;
    },
    {} as Record<Status, Doc<"tasks">[]>
  );

  return (
    <div className={styles.container}>
      <div className={styles.board}>
        {COLUMN_ORDER.map((status) => (
          <Column
            key={status}
            status={status}
            tasks={tasksByStatus[status]}
            onAddTask={onAddTask}
            onEditTask={onEditTask}
          />
        ))}
      </div>
    </div>
  );
}
```

Create src/components/Board/index.ts:
```typescript
export { Board } from "./Board";
```

Update src/App.tsx to use Board:
```typescript
import { Board } from "@/components/Board";

function App() {
  const handleAddTask = (status: string) => {
    console.log("Add task to:", status);
    // Will be implemented in Plan 05
  };

  const handleEditTask = (taskId: string) => {
    console.log("Edit task:", taskId);
    // Will be implemented in Plan 05
  };

  return (
    <main>
      <header style={{
        background: "var(--bg-secondary)",
        borderBottom: "1px solid var(--border)",
        padding: "16px 24px",
        position: "sticky",
        top: 0,
        zIndex: 50,
      }}>
        <h1 style={{
          fontSize: "22px",
          fontWeight: 600,
          color: "var(--text-primary)",
          letterSpacing: "-0.5px",
        }}>
          Loom Board
        </h1>
      </header>
      <Board onAddTask={handleAddTask} onEditTask={handleEditTask} />
    </main>
  );
}

export default App;
```
  </action>
  <verify>
- `npm run dev` shows 4-column board with tasks from Convex
- Each column shows correct status label and count
- Tasks display priority indicator, title, description, tags, due date
- Skeleton loaders appear briefly on initial load
- `npx tsc --noEmit` passes
  </verify>
  <done>
4-column Kanban board renders with tasks grouped by status, styled matching original vanilla app.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Board displays 4 columns: Backlog, In Progress, Blocked, Done
2. Tasks from Convex appear in correct columns
3. Task cards show priority color, title, description (clamped), tags, due date
4. Skeleton loaders show during initial data fetch
5. Responsive: 4 columns on desktop, 2 on tablet, 1 on mobile
6. "Add Task" buttons appear on Backlog, In Progress, Blocked (not Done)
</verification>

<success_criteria>
- 4-column board renders with tasks from Convex
- Task cards styled matching original vanilla app
- Skeleton loaders during loading
- Responsive grid layout
- TypeScript compiles with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-react-frontend/02-02-SUMMARY.md`
</output>
